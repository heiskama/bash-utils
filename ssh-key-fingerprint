#!/bin/bash
# Reference: https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html#verify-key-pair-fingerprints

# Display SSH key fingerprint in SHA-1 and MD5

require openssl

PATH_TO_PRIVATE_KEY=$1

SHA1=$(openssl pkcs8 -in $PATH_TO_PRIVATE_KEY -inform PEM -outform DER -topk8 -nocrypt | openssl sha1 -c | grep -o -E "(..:)+..")
MD5=$(openssl rsa -in $PATH_TO_PRIVATE_KEY -pubout -outform DER 2>&1 | openssl md5 -c | grep -o -E "(..:)+..")

echo "SHA-1: $SHA1" # Keys generated by AWS
echo "MD5: $MD5" # Keys imported (back) to AWS
